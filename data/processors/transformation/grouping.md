# ![Группировка](../../images/icons/components/group-data_default.svg) Группировка

Группировка выполняет действия над набором данных аналогичные действиям SQL-запроса с применением предложения `GROUP BY`. Обработчик позволяет объединять записи избранных полей в группы, а для оставшихся полей вычислять статистические показатели (сумму, среднее, минимум и т.д.). Для каждой группы возвращается одна строка. Статистические показатели (или [функции агрегации](../func/aggregation-functions.md)) при этом вычисляются для каждой группы, а не для всего набора в целом.

%spoiler%Example:%spoiler%

Source table:

| Date | Goods | Вес, кг |
| :--- | :---- | ------: |
| 12.07.2015 | Яблоки | 20 |
| 12.07.2015 | Яблоки | 18 |
| 12.07.2015 | Помидоры | 24 |
| 13.07.2015 | Помидоры | 22 |
| 13.07.2015 | Груши | 12 |
| 13.07.2015 | Груши | 16 |

В качестве полей-групп выберем поля *Дата* и *Товар*, а поле-параметр (по которому будет проводиться агрегация) — *Вес, кг*. Для примера применим три функции агрегации: сумма, количество записей и среднее.

Resulting table:

| Date | Goods | Вес, кг (Сумма) | Вес, кг (Количество) | Вес, кг (Среднее) |
| :--- | :---- | --------------: | -------------------: | ----------------: |
| 12.07.2015 | Помидоры | 24 | 1 | 24 |
| 12.07.2015 | Яблоки | 38 | 2 | 19 |
| 13.07.2015 | Груши | 28 | 2 | 14 |
| 13.07.2015 | Помидоры | 22 | 1 | 22 |

Как видно из примера, группа образуется уникальным сочетанием значений полей, выбранных в качестве группировочных.

%/spoiler%

### Input

* ![Input data source](../../images/icons/app/node/ports/inputs/table_inactive.svg) **Input data source** denotes a port for connection of the input data set.

### Output

* ![Выходной источник данных](../../images/icons/app/node/ports/inputs/table_inactive.svg) **Выходной набор данных** — порт отдающий сгруппированную таблицу.

## Wizard

Окно мастера поделено на две области.

* **Доступные поля** — содержит список полей входного набора данных.
* **Выбранные поля** — делится на списки *Группа* и *Показатели*.
   * ![Группа](../../images/icons/usage-types/group_default.svg) **Группа** — поля группировки.
   * ![Показатели](../../images/icons/usage-types/value_default.svg) **Показатели** — поля, по которым рассчитываются функции агрегации.

Для настройки требуется переместить поля входного набора в списки *Группа* или *Показатели*, перетаскивая их мышью. Так же это можно сделать с помощью кнопок : ![Переместить в Группу](../../images/icons/usage-types/group_default.svg) **Переместить в Группу** (комбинация горячих клавиш **Alt+G**) и ![Переместить в Показатель](../../images/icons/usage-types/value_default.svg) **Переместить в Показатель** (комбинация горячих клавиш **Alt+S**). Над списком доступных полей расположено поле ![](../../images/icons/toolbar-controls_18x18/toolbar-controls_18x18_filter_default.svg) *Фильтрация*, оно позволяет найти поле по имени или его части.

Настройка метода агрегации для каждого показателя производится в отдельном окне. Чтобы его открыть, нужно дважды кликнуть по полю в списке *Параметры* или вызвать это окно из контекстного меню. Далее отметить галочками нужные методы агрегации. Результат для каждого метода будет записан в отдельный столбец.

В нижней части мастера расположены два параметра отмечаемые чекбоксами:

* **Кэшировать значения групп** — результирующие данные будет [закэшированы](../../scenario/caching.md) для использования последующими узлами;
* **Сортировать результирующие данные** — данные в результирующей таблице будут отсортированы по полям группировки в зависимости от их последовательности расположения в списке *Группы*.
