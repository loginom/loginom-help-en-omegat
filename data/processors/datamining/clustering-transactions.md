# ![ ](../../images/icons/components/clope_default.svg) Transaction Clustering

## Description

Clustering is based on the [CLOPE algorithm](https://basegroup.ru/community/articles/clope). Its usage enables to process huge arrays of [transactional data](https://wiki.loginom.ru/articles/transaction.html): checks in supermarkets, tracking data of web resources, etc. It is required to provide clustering of the whole set of transactions to place all similar transactions to one cluster, whereas the transactions that differ from each other must be placed to different clusters.

The algorithm selects the count of clusters automatically. Аналитик может повлиять на результат с помощью коэффициента отталкивания, и назначения максимального числа кластеров или итераций.

To get resulting data sets, it is required to provide preliminary [training of the handler](../../scenario/training-processors.md).

## Ports

### Input

* ![ ](../../images/icons/app/node/ports/inputs-optional/table_inactive.svg) — Входной источник данных (таблица данных). Необязательный.
* ![ ](../../images/icons/app/node/ports/inputs-optional/table_inactive.svg) — Дополнительный вход (таблица данных). Необязательный.

Входные данные - это транзакции, сформированные в 2 поля, одно из которых является транзакцией, а второе - элементом. Например, первое поле - код покупателя, второе - список его покупок.

#### Requirements to the Received Data

Поля с непрерывным видом данных непригодны для обработки.

Преобразовать к требуемому виду (с полями Транзакция и Элемент) обычный набор данных, состоящий из столбцов с измеренными свойствами объектов всегда можно при помощи узлов-обработчиков Loginom, таких как [Свёртка столбцов](../../processors/transformation/rollup-columns.md) и [Калькулятор](../../processors/transformation/calc/README.md).

### Output

* ![ ](../../images/icons/app/node/ports/outputs/table_inactive.svg) — **Разбиение на кластеры.**

Таблица данных, состоящая из:

* Поля, назначение которого — "Транзакция".
* Номеров кластеров — каждой транзакции присвоен номер того кластера, в который она входит.

* ![ ](../../images/icons/app/node/ports/outputs/table_inactive.svg) — **Параметры кластеров.**

Таблица данных, состоящая из:

* Номеров кластеров — перечислены номера сформированных кластеров.
* N — количество транзакций, вошедших в кластер.
* W — ширина кластера, т.е. число уникальных объектов в нем.
* S — мощность (площадь) кластера.

## Wizard

На данном этапе необходимо задать:

* **Поля для кластеризации.**
   * Для полей, участвующих в обработке, выставить назначения "Транзакция" и "Элемент".
   * Для прочих полей оставить "Не задано".
* **Коэффициент отталкивания** — с его помощью регулируется уровень сходства транзакций внутри кластера, и, как следствие, финальное количество кластеров. Чем больше коэффициент, тем ниже уровень сходства и тем больше кластеров будет сгенерировано. По умолчанию значение коэффициента отталкивания установлено 2,6. Диапазон изменения значений от 1 до 4.
* **Ограничить число кластеров** — предполагает возможность вручную задать наибольшее количество кластеров, которые может выдать в результате алгоритм. Этой настройкой можно воспользоваться в случае, если задача требует определенного числа кластеров, например, не больше 15.
* **Ограничить число итераций** — искусственное прекращение работы алгоритма в случае, если количество итераций алгоритма превышает заданное максимальное число итераций. В алгоритме первый проход по таблице транзакций служит для построения начального разбиения, определяемого функцией стоимости, после чего для повышения качества кластеризации и оптимизации функции дополнительно сканируются таблицы несколько раз, пока изменения в разбиении не прекратятся. Ограничивать максимальное количество итераций следует в случае большого количества данных для предварительной оценки качества кластеризации.
