# ![ ](../../images/icons/components/arimax_default.svg) ARIMAX

## Description

**ARIMAX** (**A**uto**R**egressive **I**ntegrated **M**oving **A**verage e**X**tended) — это математическая модель для анализа [временных рядов](https://wiki.loginom.ru/articles/time-series.html), объединяющая в себе интегрированную [авторегрессию](https://wiki.loginom.ru/articles/autoregressive-model.html), [скользящее среднее](https://wiki.loginom.ru/articles/moving-average.html) и возможность учета дополнительных внешних [факторов](https://wiki.loginom.ru/articles/factor.html).

Модели [ARIMA](https://wiki.loginom.ru/articles/box-jenkins-model.html) применяются для решения [задач](https://wiki.loginom.ru/articles/demand-forecasting.html), в которых требуется построить прогноз на основе имеющихся данных, то есть вычислить последующие значения ряда на основе предыдущих. Временным рядом могут быть любые данные в разрезе времени, например, продажи товаров, количество заказов, поток клиентов и т.д.

> **Важно**: для получения прогнозируемых данных требуется предварительное [обучение узла](../../scenario/training-processors.md).

## Ports

### Input Ports

* ![ ](../../images/icons/app/node/ports/inputs/table_inactive.svg)  **Входной источник данных** — таблица данных. Входные данные должны соответствовать следующим требованиям:
   * Поле, соответствующее временному ряду, должно иметь назначение *Прогнозируемое*, [тип данных](../../data/datatype.md) *Вещественный* и [вид данных](../../data/datakind.md) *Непрерывный*. Такое поле должно быть только одно.
   * Поля, соответствующие дополнительным факторам, должны иметь назначение *Входное*. Ограничений на тип данных в этих полях нет, вид данных может быть любой, кроме *Неопределённого*. Данные поля могут отсутствовать или присутствовать в любом количестве.

### Output Ports

* ![ ](../../images/icons/app/node/ports/outputs/table_inactive.svg) **Выход модели** — таблица данных, которая содержит следующие поля:
   * Имя_поля|Прогноз — прогнозируемые значения исходного временного ряда.
   * Имя_поля|Ошибка [аппроксимации](https://wiki.loginom.ru/articles/approximation.html) — остатки модели, отклонения между прогнозируемыми и фактическими значениями ряда. Поле присутствует, если установлен флаг *Рассчитать ошибку аппроксимации*.
   * Имя_поля|Нижняя граница — нижняя граница [доверительного интервала](https://wiki.loginom.ru/articles/confidence-interval.html). Поле присутствует, если установлен флаг *Рассчитать доверительный интервал*.
   * Имя_поля|Верхняя граница — верхняя граница доверительного интервала. Поле присутствует, если установлен флаг *Рассчитать доверительный интервал*.
* ![ ](../../images/icons/app/node/ports/outputs/table_inactive.svg)  **Коэффициенты модели** — таблица данных, которая содержит следующие коэффициенты:
   * Тип
   * Параметр
   * [Лаг](https://ru.wikipedia.org/wiki/%D0%9B%D0%B0%D0%B3%D0%BE%D0%B2%D1%8B%D0%B9_%D0%BE%D0%BF%D0%B5%D1%80%D0%B0%D1%82%D0%BE%D1%80)
   * Имя входного поля
   * Уникальное значение
   * Коэффициент
   * [Стандартное отклонение](https://wiki.loginom.ru/articles/mean-square-deviation.html)
   * [T-статистика](https://wiki.loginom.ru/articles/students-distribution.html)
   * [P-value](https://wiki.loginom.ru/articles/p-value.html)
* ![ ](../../images/icons/app/node/ports/outputs/variable_inactive.svg) **Сводка** — переменные:
   * Всего примеров (TotalSamples)
   * Всего отобранных примеров (TotalSelectedSamples)
   * Примеров в [обучающем множестве](https://wiki.loginom.ru/articles/training-set.html) (TrainSamples)
   * Среднеквадратическая ошибка на обучающем множестве (TrainRMSError)
   * Средняя абсолютная ошибка на обучающем множестве (TrainAvgError)
   * Средняя относительная ошибка на обучающем множестве (TrainAvgRelError)
   * Информационный критерий Акаике ([AIC](https://wiki.loginom.ru/articles/aic.html))
   * Информационный критерий Акаике скорректированный ([AICc](https://wiki.loginom.ru/articles/aicc.html))
   * Информационный критерий Байеса ([BIC](https://wiki.loginom.ru/articles/bic.html))
   * Коэффициент детерминации ([R2](https://wiki.loginom.ru/articles/coefficient-of-determination.html))
   * Скорректированный коэффициент детерминации ([AdjustedR2](https://wiki.loginom.ru/articles/coefficient-determ-adj.html))
   * Число [степеней свободы](https://wiki.loginom.ru/articles/degrees-of-freedom.html) модели (ModelDF)
   * Число степеней свободы остатков (ResDF)

## Wizard

### Step 1. Настройка входных столбцов

На первом этапе необходимо задать [назначение](../../data/datasetfieldoptions.md) столбцов входного набора данных. Для каждого из столбцов можно выбрать один из вариантов назначения:

* ![ ](../../images/icons/usage-types/forecast_default.svg) **Прогнозируемое** — для данных, соответствующих временному ряду.
* ![ ](../../images/icons/usage-types/active_default.svg) **Входное** — для данных, соответствующих дополнительным входным факторам.
* ![ ](../../images/icons/usage-types/unspecified_default.svg) **Не задано** — для данных, не участвующих в построении модели. Устанавливается по умолчанию для остальных столбцов.

### Step 2. Настройки нормализации

Для моделей ARIMA [нормализация](../normalization/README.md) для прогнозируемых данных обычно не требуется. Рекомендуется не применять нормализацию для данных временного ряда, для данных внешних факторов не менять настройки по умолчанию.

### Step 3. Настройки ARIMAX

#### Структура модели ARIMAX

* **Определить структуру автоматически** — при установке данного флага активируется автоподбор параметров модели. Параметры в процессе вычисления подбираются таким образом, чтобы минимизировать значение *AIC*.
* **Порядок AR части** — задает порядок (р) авторегрессионной части. Определяет  число предыдущих значений ряда, учитываемых при построении модели. Устанавливается значение целого типа больше 0.
* **Порядок интегрирования** — задает порядок (d) разностей ряда при необходимости привести исходный ряд к [стационарному](https://ru.wikipedia.org/wiki/%D0%A1%D1%82%D0%B0%D1%86%D0%B8%D0%BE%D0%BD%D0%B0%D1%80%D0%BD%D0%BE%D1%81%D1%82%D1%8C). Устанавливается значение целого типа больше 0.
* **Порядок MA части** — задает порядок (q) части скользящего среднего. Определяет  размер скользящего окна для сглаживания исходного ряда. Устанавливается значение целого типа больше 0.
* **Включить расчет сезонности** — установка данного флага позволяет задать параметры для [сезонной составляющей](https://wiki.loginom.ru/articles/seasonal-component.html):
   * **Порядок сезонной AR части** — устанавливает значение целого типа от 0 и выше.
   * **Порядок сезонного  интегрирования** — устанавливает значение целого типа от 0 и выше.
   * **Порядок сезонной MA части** — устанавливает значение целого типа от 0 и выше.
   * **Период сезонной составляющей** — устанавливает положительное значение целого типа.
* **Включить константу в модель** — значение логического типа. По умолчанию включено.

#### Прогнозирование временных рядов

* **[Горизонт прогноза](https://wiki.loginom.ru/articles/time-horizon.html)** — задает количество значений, которые будут спрогнозированы и добавлены в выходной набор в конце исходного временного ряда. Устанавливает значение целого типа больше 1.
* **Рассчитать ошибку аппроксимации** — флаг, установка которого добавляет в выходной набор столбец со средними отклонениями прогнозируемых значений от фактических.
* **Рассчитать доверительный интервал** — позволяет вручную задать настройку следующего параметра:
   * Доверительный интервал прогноза в % от 0 до 100 — значение вещественного типа, по умолчанию 95.
