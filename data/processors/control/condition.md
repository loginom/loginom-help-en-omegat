# ![Условие](../../images/icons/components/condition_default.svg) Условие

Компонент используется в точке разветвления сценария в качестве переключателя между вариантами обработки данных. В соответствии с заданными ему условиями выполняется только одна ветвь сценария и блокируется выполнение всех остальных.

Выявление активной ветви происходит по следующему принципу:

1. Ветви проверяются на истинность последовательно по списку сверху вниз, начиная с самой первой;
1. При выявлении ветви со значением "истина" проверка останавливается, ветвь становится активной, а остальные блокируются, даже если ниже по списку остались истинные;
1. Если все ветви примут значение "ложь", то будет активизирована специальная ветвь *Иначе*.

## Ports

Изначально входных и выходных [портов](../../scenario/ports/README.md) нет, они создаются пользователем в мастере настройки. При первоначальной настройке достаточно добавить входные порты и сохранить настройки компонента. Настройка списка условий при этом не требуется, так как в компонент ещё не передана структура входных данных. Порты могут быть следующих типов:

### Input

* ![Входные переменные](../../images/icons/app/node/ports/inputs/variable_inactive.svg) **Входные переменные** — набор переменных;
* ![Входной источник данных](../../images/icons/app/node/ports/inputs/table_inactive.svg) **Входной источник данных** — таблица данных.

### Output

* ![Выходные переменные](../../images/icons/app/node/ports/outputs/variable_inactive.svg) **Выходные переменные** — набор переменных;
* ![Выходной набор данных](../../images/icons/app/node/ports/outputs/table_inactive.svg) **Выходной набор данных** — таблица данных.

## Wizard

### Step 1. Настройка портов узла

Здесь задается наличие необходимых портов. Каждому порту можно задать тип, имя и название, которое будет отображаться при наведении курсора на него.

* ![Создать новый порт](../../images/icons/toolbar-controls/plus_default.svg) **Добавить** — создать новый порт входа:
   * ![Для переменных](../../images/icons/app/node/ports/inputs/variable_hover.svg) **Переменные** — для переменных.
   * ![Для таблицы](../../images/icons/app/node/ports/inputs/table_hover.svg) **Таблица** — для таблицы.
* ![Смещение порта вниз](../../images/icons/toolbar-controls/movedown_default.svg) **Переместить вниз**, ![Смещение порта вверх](../../images/icons/toolbar-controls/moveup_default.svg) **Переместить вверх** — путем смещения выделенного порта определить его положение относительно узла компонента.
* ![Редактировать параметры порта](../../images/icons/toolbar-controls/edit_default.svg) **Редактировать** — редактировать параметры порта.
* ![Создание выхода](../../images/icons/checkbox-states/checked_default.svg) **Передавать на выход** — для выделенного входного порта будет создан порт выхода в каждой ветви.
* ![Удалить порт](../../images/icons/toolbar-controls/delete_default.svg) — удалить порт.
* ![Удалить все порты](../../images/icons/toolbar-controls/delete-all_default.svg) — удалить все порты.

### Step 2. Настройка списка условий

**Список ветвей условия** — содержит варианты дальнейшего выполнения сценария.

* ![Добавить ветвь](../../images/icons/toolbar-controls/plus_default.svg) **Добавить** — добавить новую ветвь условия;
* ![Переместить ветвь вниз](../../images/icons/toolbar-controls/movedown_default.svg) **Переместить вниз**, ![Переместить ветвь вверх](../../images/icons/toolbar-controls/moveup_default.svg) **Переместить вверх** — установить приоритет выделенной ветви путем её смещения относительно других ветвей;
* ![Удалить ветвь](../../images/icons/toolbar-controls/delete_default.svg) — удалить ветвь;
* ![Удалить все ветви](../../images/icons/toolbar-controls/delete-all_default.svg) — удалить все ветви условий.

**Условие** — область конфигурации условий для конкретной ветви, отображается при выделении ветви в списке.

* ![Добавить новое условие](../../images/icons/filterdata/filterdata-add_18x18.svg) — добавить в ветвь новое условие, после нажатия открывается окно для его настройки:
   * **Поле** — содержит список всех переменных, столбцов таблиц и указатель записей таблиц, поданных на входные порты компонента. Выбранный объект будет использован для сравнения.
   * **Агрегация** — содержит список методов [агрегации](../func/aggregation-functions.md), применимых к полям таблиц. Список недоступен для полей-переменных.
   * **Условие** — выбор метода сравнения.
   * **Сравниваемое значение** — значение, с которым будет сравниваться выбранный объект.
* **И/ИЛИ** — кнопка-переключатель появляется между двумя условиями в ветви:
   * **И** — связываемые условия дадут значение "истина", если они оба истинны.
   * **ИЛИ** — связываемые условия дадут значение "истина", если истинно хотя бы одно из них.
* ![**Удалить все условия**](../../images/icons/toolbar-controls/delete-all_default.svg) **Удалить все условия** — удалить все условия для выбранной ветви.

> **Примечание:** условие проверяется на атомарных значениях, например "A > 1". Таким значением может быть переменная. Если же на вход подана таблица, то поле обозначает не одно значение, а целую колонку. В этом случае данную колонку необходимо свети к одному значению с помощью методов агрегации.
>
> **ВАЖНО**: при написании сложных условий приоритет будет у оператора **И**.
> Например, сложное условие вида: "A **ИЛИ** B **И** C **ИЛИ** D **И** E **И** F" удет выполняться следующим образом: "A **ИЛИ** (B **И** C) **ИЛИ** (D **И** E **И** F)"

**Режим отладки** ![Режим отладки](../../images/icons/checkbox-states/checked_default.svg) — применяется для проверки корректности данных на выходных портах вне зависимости от условий. Активны будут ветви, указанные в списке *Выполнять ветвь условия*, который включает в себя:

* **Список пользовательских ветвей** — добавленные пользователем ветви, можно выбрать одну из них;
* **Все ветви** — активирует выполнение всех ветвей, в том числе ветвь *Иначе*;
* **Иначе** — активирует выполнение только ветви *Иначе*.
