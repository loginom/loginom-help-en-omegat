# ![ ](../../images/icons/components/extract-xml_default.svg) Извлечение XML

## Description

Обработчик извлекает таблицу данных из столбца входной таблицы, в ячейках которого содержатся документы XML в строковом виде. Все документы из столбца должны соответствовать подключенной [XSD-схеме](https://ru.wikipedia.org/wiki/XML_Schema_%28W3C%29).

## Ports

### Input

* ![ ](../../images/icons/app/node/ports/inputs/link_inactive.svg) — Поключение к источнику XSD-схемы — подключение настроенного ранее подключения к файлам [XSD-схем](../../integration/connections/list/schemes.md).
* ![ ](../../images/icons/app/node/ports/inputs-optional/variable_inactive.svg) —  Управляющие переменные (переменные), необязательный.
* ![ ](../../images/icons/app/node/ports/inputs/table_inactive.svg) — Источник данных — таблица данных, содержащая ячейки с документами XML.

### Output

* ![ ](../../images/icons/app/node/ports/outputs/table_inactive.svg) — Набор данных — таблица данных, извлеченных из документов XML.
   * Поля, наличие которых задается пользователем:
      * Идентификатор поля — показывает, из какого именно документа была извлечена конкретная строка.

* ![ ](../../images/icons/app/node/ports/outputs/table_inactive.svg) — Ошибки и коды завершения — таблица логов извлечения, имеет следующую структуру:
   * Обязательные поля:
      * Код завершения — содержит значения кодов извлечения для каждого документа.
   * Поля, наличие которых задается пользователем:
      * Идентификатор поля — показывает, какому документу соответствует запись в таблице логов;
      * Описание ошибки — описание кодов завершения.

## Wizard

### Step 1. Параметры извлечения XML

* **Столбец, содержащий XML** — выбор столбца с документами XML.

* **Идентификация XML-документа** — в этой области определяется наличие столбца идентификаторов в извлекаемой таблице и в таблице логов:
   * Использовать идентификатор — флаг включает идентификаторы. Далее с помощью радиокнопки определяется тип идентификаторов:
      * Номер строки входного набора — номер строки, в которой содержится документ. Первой строке соответствует идентификатор 0.
      * Значение столбца — в качестве идентификаторов будут использованы значения выбранного столбца входной таблицы.

* **Останавливаться при ошибках** — данный флаг отменит извлечение при обнаружении первой ошибки.

* **Разэкранировать сущности XML** — применяется в том случае, если документы извлекаются из другого документа XML, в котором они были заэкранированы. При отсутствии данного флага извлечение документа, начинающегося, например, с объявления `&lt;`

```xml
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt
```

выдаст ошибку, а при наличии флага обработчик интерпретирует такое объявление как корректное:

```xml
<?xml version=«1.0» encoding=«UTF-8»?>
```

* **Выдавать описание кодов завершения** — в таблицу с логами будет добавлен столбец "Описание ошибки".

### Step 2. Импортируемые поля

* **Подключение** — состояние подключения к XSD-схеме.

* **Корневой элемент** — выбор корневого элемента XSD-схемы, в соответствии с которым данные будут извлекаться. Ниже расположена область, отображающая иерархическую структуру выбранного корневого элемента — в ней следует отметить флагами элементы, которые сформируют поля извлекаемой таблицы.

* **Временная зона по умолчанию** — значения с типом *Дата/Время* преобразуются при извлечении из XML по следующему алгоритму:
   * Если значение содержит указание временной зоны, оно преобразуется к текущей временной зоне сервера Loginom.
   * Если значение не содержит указание временной зоны, то:
      * если *Временная зона по умолчанию* задана, значение преобразуется к текущей временной зоне сервера Loginom в предположении, что имеет временную зону, указанную в параметре *Временная зона по умолчанию*.
      * если *Временная зона по умолчанию* не задана, значение остается без изменений.

* **Дублировать единичные значения** — если в составе последовательности имеется единичный элемент и вложенная последовательность, значения единичного элемента будут продублированы для каждой строки, образованной из вложенной последовательности.

* **Проверять на строгое соответствие XSD** — при установке флага производится валидация XML на строгое соответствие XSD схеме. В противном случае проверка производится в упрощенном, ускоренном режиме. Процесс проверки в упрощенном режиме происходит быстрее, однако не гарантирует корректное извлечение данных из XML в случае, если имеются невыявленные ошибки валидации.

* **Генерировать составные метки полей** — при наличии данного флага в каждой метке поля будет отражена иерархия относительно корневого элемента. Например, составная метка "ROOT|PERSON|ACCES-LEVEL" будет сформирована для поля извлеченной таблицы, содержащего данные атрибута "ACCESS-LEVEL" элемента "PERSON" из корневого элемента "ROOT" документа. При отсутствии флага поле получит название "ACCESS-LEVEL".
